# MMT-HTTP-AND-SETUP-PROJECT

## Node.js Express Backend Basic Project

### üì¶ Kh·ªüi t·∫°o d·ª± √°n

```sh
node --version
v20.19.0

# Kh·ªüi t·∫°o package.json m·∫∑c ƒë·ªãnh
npm init -y

# C√†i Express v√† Nodemon
npm install express
npm install --save-dev nodemon
```

### ‚öôÔ∏è C·∫•u h√¨nh scripts trong package.json

```json
"scripts": {
  "start": "node index.js",
  "dev": "nodemon index.js"
}
```

### üìù index.js

```js
// ====================== IMPORTS ======================
const express = require('express');

const app = express();
const port = 3000;

// Middleware parse JSON
app.use(express.json());

// Route g·ªëc
app.get('/', (req, res) => {
  res.send('Hello World!');
});

// ====================== START SERVER ======================
app.listen(port, () => {
  console.log(`Server running at http://localhost:${port}`);
});
```

### üöÄ Ch·∫°y server

- Ch·∫°y b·∫±ng Node.js:

```sh
npm run start
```

- Ch·∫°y trong ch·∫ø ƒë·ªô ph√°t tri·ªÉn (t·ª± reload khi thay ƒë·ªïi code):

```sh
npm run dev
```

- M·ªü tr√¨nh duy·ªát v√†o: `http://localhost:3000` ‚Üí s·∫Ω th·∫•y `Hello World!`

![](./images/HelloWorld.png)

## Frontend React Single Page Application

### üì¶ T·∫°o project React

```bash
# T·∫°o React app trong th∆∞ m·ª•c 'frontend'
npx create-react-app frontend

# V√†o th∆∞ m·ª•c frontend
cd frontend
```

### üìù App.js (fetch API t·ª´ backend)

```js
import { useEffect, useState } from 'react';
import './App.css';

function App() {
  const [message, setMessage] = useState('');

  useEffect(() => {
    // G·ªçi API backend
    fetch('http://localhost:3000/api/test')
      .then((res) => res.text())
      .then((data) => setMessage(data))
      .catch((err) => console.error(err));
  }, []);

  return (
    <div className="App">
      <header className="App-header">
        {/* Hi·ªÉn th·ªã message t·ª´ backend */}
        <p>{message ? message : 'Loading...'}</p>
      </header>
    </div>
  );
}

export default App;
```

### üìù Index.js (backend)

```js
const path = require('path');
app.get('/api/test', (req, res) => {
    res.json({ message: 'Hello World!' });
});

// ====================== REACT BUILD (SPA) ======================
app.use(express.static(path.join(__dirname, 'frontend', 'build')));
app.get(/.*/, (req, res) => {
    res.sendFile(path.join(__dirname, 'frontend', 'build', 'index.html'));
});
```

### Build React (npm run build), Express s·∫Ω serve to√†n b·ªô SPA t·ª´ frontend/build. 

```sh
cd frontend && npm run build

npm run dev -> backend port 3000
cd frontend && npm start -> frontend port 3001
```

![](images/build.png)

![](images/run.png)

### ‚ö†Ô∏è L·ªói CORS khi ch·∫°y React + backend

**Tri·ªáu ch·ª©ng**
- Khi frontend React (`npm start`) tr√™n port 3000 ho·∫∑c 3001 g·ªçi API backend tr√™n port kh√°c, tr√¨nh duy·ªát b√°o l·ªói:

```
Access to fetch at 'http://localhost:3000/api/test' from origin 'http://localhost:3001' has been blocked by CORS policy
```

**Nguy√™n nh√¢n**
- Tr√¨nh duy·ªát **ch·∫∑n request cross-origin** (port kh√°c) v√¨ l√Ω do b·∫£o m·∫≠t.

![](images/CORS_Error.png)

**C√°ch kh·∫Øc ph·ª•c**

```js
index.js

const cors = require('cors');
app.use(cors({
    origin: [`http://localhost:${port}`, 'http://localhost:3001'],
    methods: ['GET', 'POST', 'PUT', 'DELETE'],
    allowedHeaders: ['Content-Type', 'Authorization'],
    credentials: true
}));
```

![](images/CORS.png)

### HTTP ‚Äì HyperText Transfer Protocol

**Kh√°i ni·ªám**
- HTTP l√† **giao th·ª©c ·ª©ng d·ª•ng** ƒë·ªÉ client (tr√¨nh duy·ªát) v√† server trao ƒë·ªïi d·ªØ li·ªáu tr√™n m·∫°ng.
- Ho·∫°t ƒë·ªông theo m√¥ h√¨nh **request ‚Üí response**.

**Flow c∆° b·∫£n**
1. Client g·ª≠i **request** t·ªõi server.
   - C√°c method ph·ªï bi·∫øn: `GET`, `POST`, `PUT`, `DELETE`.
2. Server x·ª≠ l√Ω request v√† tr·∫£ v·ªÅ **response** g·ªìm:
   - **Status code**: 200 (OK), 404 (Not Found), 500 (Server Error)‚Ä¶
   - **Headers**: th√¥ng tin metadata nh∆∞ `Content-Type`, `Authorization`‚Ä¶
   - **Body**: d·ªØ li·ªáu tr·∫£ v·ªÅ, c√≥ th·ªÉ l√† HTML, JSON, CSS, JS‚Ä¶

![](https://www.omgwiki.org/dido/lib/exe/fetch.php?w=500&tok=e9e2b1&media=dido:public:ra:xapend:xapend.a_glossary:h:screen_shot_2021-04-22_at_2.05.37_pm.png)

**V√≠ d·ª•**
```json
# Request
GET /api/test HTTP/1.1
Host: localhost:3000

# Response
HTTP/1.1 200 OK
Content-Type: application/json

{
  "message": "Hello World!"
}
```

### üîπ L∆∞u √Ω
- HTTP l√† **stateless**, m·ªói request l√† ƒë·ªôc l·∫≠p.
- RESTful API x√¢y d·ª±ng tr√™n HTTP gi√∫p client v√† server giao ti·∫øp theo chu·∫©n.

### ‚öôÔ∏è C∆° ch·∫ø React SPA + Backend Express

**Khi ch·∫°y development (npm start React + backend Node.js)**

```
[Client Browser] 
      |
      | HTTP GET / -> request dev server React (v√≠ d·ª• port 3001)
      v
[React Dev Server] 
      |
      | serve index.html + bundle JS, CSS
      v
[Client Browser] -> React JS bundle ch·∫°y, render UI
      |
      | fetch('/api/...') -> REST API (backend port 3000)
      v
[Backend Express] -> JSON response
      |
      v
[Client Browser] -> Update UI
```

- React ch·∫°y tr√™n **dev server** (hot reload, port 3000/3001)  
- Backend Node.js x·ª≠ l√Ω API ri√™ng, c√≥ th·ªÉ ch·∫°y tr√™n port kh√°c  
- N·∫øu frontend v√† backend kh√°c port ‚Üí c·∫ßn **proxy** ho·∫∑c **CORS middleware**

---

**Khi build production (npm run build React + serve b·∫±ng Express)**

```
[Client Browser] 
      |
      | HTTP GET / -> request index.html
      v
[Backend Express] 
      |
      | serve frontend/build/index.html
      v
[Client Browser] 
      |
      | Browser t·∫£i c√°c file JS, CSS li√™n k·∫øt trong index.html
      v
[Client Browser] -> React JS bundle ch·∫°y, render UI
      |
      | fetch('/api/...') -> REST API tr√™n c√πng backend
      v
[Backend Express] -> JSON response
      |
      v
[Client Browser] -> Update UI
```

- React build ra **static files** (index.html + JS + CSS)  
- Express serve to√†n b·ªô SPA v√† x·ª≠ l√Ω REST API  
- Kh√¥ng c√≤n v·∫•n ƒë·ªÅ CORS v√¨ frontend v√† backend ch·∫°y c√πng port  

![](https://media.geeksforgeeks.org/wp-content/uploads/20240726124329/Architechture-Of-SPA.webp)

---

**T√≥m t·∫Øt**
- **Dev mode**: React dev server + backend port kh√°c ‚Üí c·∫ßn proxy/CORS  
- **Production build**: React static bundle + backend c√πng port ‚Üí SPA + REST API ch·∫°y m∆∞·ª£t m√†

### üõ†Ô∏è S·ª≠ d·ª•ng DevTools c·ªßa tr√¨nh duy·ªát

**1Ô∏è‚É£ M·ªü DevTools**
- Chrome / Edge / Firefox: nh·∫•n **F12** ho·∫∑c **Ctrl+Shift+I** (Windows) / **Cmd+Option+I** (Mac)
- Bao g·ªìm c√°c tab quan tr·ªçng:
  - **Elements**: xem c·∫•u tr√∫c DOM, CSS
  - **Console**: xem log JS, l·ªói
  - **Network**: theo d√µi request/response HTTP
  - **Sources**: xem code JS/React bundle

---

**2Ô∏è‚É£ Theo d√µi API call**
1. M·ªü tab **Network**
2. Nh·∫•n n√∫t g·ªçi API trong React (v√≠ d·ª• "Refresh API" button)
3. Quan s√°t request:
   - **Method**: GET, POST‚Ä¶
   - **URL**: `/api/test`
   - **Status**: 200 OK
   - **Response**: `{ "message": "Hello World!" }`

![](images/network.png)

---
